# Инструкция по настройке локализации Flutter приложения

## Хронологический порядок действий

### ШАГ 1: Подготовка Flutter зависимостей

**Что делать:**
- Добавить `flutter_localizations` в раздел `dependencies` в `pubspec.yaml`
- Добавить `intl` пакет в раздел `dependencies` в `pubspec.yaml`
- Добавить параметр `generate: true` в секцию `flutter:` в `pubspec.yaml`
- Выполнить `flutter pub get` в терминале

---

### ШАГ 2: Создание конфигурационного файла локализации

**Что делать:**
- Создать файл `l10n.yaml` в корне папки `frontend/` (на одном уровне с `pubspec.yaml`)

---

### ШАГ 3: Создание папки для файлов переводов

**Что делать:**
- Создать папку `lib/l10n/` внутри папки `frontend/`

---

### ШАГ 4: Создание базового файла переводов (английский)

**Что делать:**
- Создать файл `app_en.arb` в папке `lib/l10n/`
- Добавить базовые строки приложения на английском языке

---

### ШАГ 5: Создание файлов переводов для других языков

**Что делать:**
- Создать файл `app_ru.arb` в папке `lib/l10n/` (или другие языки по необходимости)
- Добавить переводы всех строк на соответствующий язык

---

### ШАГ 6: Генерация кода локализации

**Что делать:**
- Выполнить `flutter pub get` в терминале
- Выполнить `flutter gen-l10n` в терминале
- Проверить, что создалась папка `lib/l10n/generated/` с файлами локализации

---

### ШАГ 7: Настройка MaterialApp в main.dart

**Что делать:**
- Добавить импорт `flutter_localizations`
- Добавить импорт сгенерированного файла локализации
- Добавить `localizationsDelegates` в `MaterialApp`
- Добавить `supportedLocales` в `MaterialApp`

---

### ШАГ 8: Настройка iOS - Info.plist

**Что делать:**
- Открыть Xcode проект: `frontend/ios/Runner.xcworkspace`
- В навигаторе проекта выбрать файл `Runner/Info.plist`
- Добавить ключ `CFBundleLocalizations` (тип Array)
- Добавить строковые элементы в массив: `en`, `ru` (и другие языки)
- Сохранить изменения

---

### ШАГ 9: Настройка iOS - Project Settings (опционально, для App Store)

**Что делать:**
- В Xcode открыть настройки проекта (нажать на проект Runner в навигаторе)
- Выбрать таргет Runner
- Перейти на вкладку "Info"
- В разделе "Localizations" добавить поддерживаемые языки
- Подтвердить создание файлов локализации (если предложит)

---

### ШАГ 10: Настройка Android - build.gradle.kts

**Что делать:**
- Открыть файл `frontend/android/app/build.gradle.kts`
- В секции `android { defaultConfig { } }` добавить `resValue` для строк приложения
- Сохранить файл

---

### ШАГ 11: Создание папок ресурсов для Android (опционально)

**Что делать:**
- Создать папку `android/app/src/main/res/values/` (если не существует)
- Создать файл `strings.xml` в папке `values/`
- Создать папку `android/app/src/main/res/values-ru/` (для русского языка)
- Создать файл `strings.xml` в папке `values-ru/`
- Добавить базовые строки в оба файла

---

### ШАГ 12: Замена хардкодных строк на вызовы локализации

**Что делать:**
- Найти все хардкодные строки в коде приложения
- Заменить их на вызовы `AppLocalizations.of(context)!.ключ_строки`
- Начать с `main.dart`, затем пройтись по всем экранам в `screens/`
- Проверить виджеты в `widgets/`

---

### ШАГ 13: Тестирование локализации

**Что делать:**
- Запустить приложение на iOS устройстве/симуляторе
- Изменить язык устройства в настройках iOS
- Проверить, что приложение переключилось на выбранный язык
- Запустить приложение на Android устройстве/эмуляторе
- Изменить язык устройства в настройках Android
- Проверить, что приложение переключилось на выбранный язык

---

### ШАГ 14: Дополнительная настройка (если нужно)

**Что делать:**
- Если нужно программно менять язык без перезапуска приложения, создать провайдер или сервис для хранения выбранного языка
- Настроить начальную локализацию в `MaterialApp` через параметр `locale`
- Добавить обработку отсутствующих переводов через `fallbackLocale`

---

## Важные замечания

1. **Порядок критичен**: некоторые шаги зависят от результатов предыдущих (например, генерация кода нужна перед настройкой MaterialApp)

2. **Xcode изменения**: изменения в Xcode нужно делать после генерации кода локализации, чтобы понимать, какие языки поддерживаются

3. **Android изменения**: настройки Android можно делать параллельно с iOS, но лучше после генерации кода

4. **Тестирование**: обязательно тестировать на обеих платформах после всех изменений

5. **Добавление новых языков**: в будущем для добавления нового языка достаточно создать новый `app_XX.arb` файл, добавить язык в `supportedLocales` и обновить настройки iOS/Android

